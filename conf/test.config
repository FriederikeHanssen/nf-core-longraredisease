/*
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Nextflow config file for running minimal tests
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
*/
executor {
    name = 'local'
    cpus = 8          
    memory = '16.GB'  
    queueSize = 10     
}
process {
    resourceLimits = [       
        cpus: 1,
        memory: '10.GB'   
    ]
}
trace.fields = "task_id,hash,native_id,script"

params {
    // ========================================
    // MAIN ANALYSIS TOGGLES
    // ========================================
    // input                       = "${projectDir}/assets/samplesheet.csv"
    align_with_bam              = true     // Enable alignment
    align_with_fastq            = false   // Enable alignment with FASTQ files  // Sample name for the analysis or patient's ID
    generate_bam_stats          = true       // Enable generation of BAM statistics
    generate_coverage           = true       // Enable generation of coverage statistics
    sv                          = true       // Enable structural variant calling
    snv                         = true     // Enable SNV calling  
    cnv                         = true     // Enable CNV calling
    str                         = true     // Enable STR analysis
    phase                       = false       // Enable phasing analysis
    qc                          = true     // Enable quality control
    methyl                      = true     // Enable methylation calling
    fasta_file                  = "${projectDir}/assets/test_data/genome_22/genome_22.fasta"
    str_bed_file                = "${projectDir}/assets/test_data/straglr/str.test.bed"
    outdir                      = './results'

    
    
    // ========================================
    // Consensus SV FILTERING PARAMETERS
    // ========================================
    consensuSV                 = true      // Enable multi-caller SV filtering
    use_survivor_bed           = true
    max_distance_breakpoints    = 1000
    min_supporting_callers      = 3
    account_for_type            = 1
    account_for_sv_strands      = 1
    estimate_distanced_by_sv_size = 1
    min_sv_size                 = 30
    refdist                     = 1000
    pctsim                      = 0.7
    pctseq                      = 0.7
    passonly                    = true
    dup_to_ins                  = false
   
    
    // ========================================
    // SV FILTERING PARAMETERS
    // ========================================
    filter_sv                   = true   // Enable SV filtering by coverage
    filter_pass_sv              = true       // Filter PASS variants only in SV 
    min_read_support            = 'auto'
    min_read_support_limit      = 2

    // ========================================
    // SNV CALLING PARAMETERS
    // ========================================
    deepvariant                 = true
    merge_snv                   = true // Unify SNV VCFs from CLAIR3 and Deepvariant to upload to GeneYX
    filter_pass_snv             = true       // Filter PASS variants only in SNV 
    clair3_model                = "ont" // if this model is not found use ont. Use this model in docker r1041_e82_400bps_sup_v500
    clair3_platform             = "ont"
    
    
    // ========================================
    // PHASING PARAMETERS
    // ========================================
    phase_with_sv               = true
    
    // ========================================
    // CNV CALLING PARAMETERS
    // ========================================
    // QDNASEQ
    run_qdnaseq                 = true
    genome_build                = 'hg38'
    qdnaseq_bin_size            = 1000
    method                      = 'cutoff'
    cutoff                      = 0.5
    cutoff_del                  = 0.5
    cutoff_loss                 = 1.5
    cutoff_gain                 = 2.5
    cellularity                 = 1
    
    // Spectre test parameters
    use_test_data                    = true // Use test data for Spectre - can not run it in test pipeline because does not accept subset of data.
    spectre_test_mosdepth            = "${projectDir}/assets/test_data/spectre/mosdepth.regions.bed.gz"
    spectre_test_fasta_file          = "s3://ngi-igenomes/igenomes/Homo_sapiens/NCBI/GRCh38/Sequence/WholeGenomeFasta/genome.fa"
    spectre_test_clair3_vcf          = "${projectDir}/assets/test_data/spectre/test_clair3_merge_output.vcf.gz"
    
    // ========================================
    // VCF UNIFICATION PARAMETERS
    // ========================================
    modify_str_calls            = true    // or true if Straglr is used
    unify_geneyx                = true    // Enable VCF unification

}
